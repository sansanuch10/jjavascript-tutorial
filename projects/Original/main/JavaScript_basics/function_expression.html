<main><page-content><nav-up><home- data-load_page="0" hover-style=""></home-><arrow-next></arrow-next><a data-load_page="1">Язык JavaScript</a><arrow-next></arrow-next><a data-load_page="7">Основы JavaScript</a></nav-up><h1>Функциональные выражения</h1><p>В JavaScript функция является значением, таким же как строка или число.</p><p>Как и любое значение, объявленную функцию можно вывести, вот так:</p><code-example><script>`function sayHi() {\n  alert( 'Привет' );\n}\n\nMARKalert( sayHi ); // выведет код функции`</script><code-toolbar></code-toolbar></code-example><p>Обратим внимание на то, что в последней строке после <code>sayHi</code> нет скобок. То есть, функция не вызывается, а просто выводится на экран.</p><p><strong>Функцию можно скопировать в другую переменную:</strong></p><code-example><script>`function sayHi() {   // (1)\n  alert( 'Привет' );\n}\n\nvar func = sayHi;    // (2)\nfunc();              // (3) Привет\n\nsayHi = null;\nsayHi();             // (4) ошибка`</script><code-toolbar></code-toolbar></code-example><ol><li>Объявление <code>(1)</code> как бы говорит интерпретатору "создай функцию и помести её в переменную <code>sayHi</code></li><li>В строке <code>(2)</code> мы копируем функцию в новую переменную <code>func</code>. Ещё раз обратите внимание: после <code>sayHi</code> нет скобок. Если бы они были, то вызов <code>var func = sayHi()</code> записал бы в <code>func</code><em>результат</em> работы <code>sayHi()</code> (кстати, чему он равен? правильно, <code>undefined</code>, ведь внутри <code>sayHi</code> нет <code>return</code>).</li><li>На момент <code>(3)</code> функцию можно вызывать и как <code>sayHi()</code> и как <code>func()</code></li><li>…Однако, в любой момент значение переменной можно поменять. При этом, если оно не функция, то вызов <code>(4)</code> выдаст ошибку.</li></ol><p>Обычные значения, такие как числа или строки, представляют собой <em>данные</em>. А функцию можно воспринимать как <em>действие</em>.</p><p>Это действие можно запустить через скобки <code>()</code>, а можно и скопировать в другую переменную, как было продемонстрировано выше.</p><h2><a name="0" href="#0">Объявление Function Expression</a></h2><p>Существует альтернативный синтаксис для объявления функции, который ещё более наглядно показывает, что функция – это всего лишь разновидность значения переменной.</p><p>Он называется «Function Expression» (функциональное выражение) и выглядит так:</p><code-example><script>`var f = function(параметры) {\n  // тело функции\n};`</script></code-example><p>Например:</p><code-example><script>`var sayHi = function(person) {\n  alert( 'Привет,&nbsp' + person );\n};\n\nsayHi('Вася');`</script><code-toolbar></code-toolbar></code-example><h2><a name="1" href="#1">Сравнение с Function Declaration</a></h2><p>«Классическое» объявление функции, о котором мы говорили до этого, вида <code>function имя(параметры) {...}</code>, называется в спецификации языка «Function Declaration».</p><ul><li><em>Function Declaration</em> – функция, объявленная в основном потоке кода.</li><li><em>Function Expression</em> – объявление функции в контексте какого-либо выражения, например присваивания.</li></ul><p>Несмотря на немного разный вид, по сути две эти записи делают одно и то же:</p><code-example><script>`// Function Declaration\nfunction sum(a, b) {\n  return a + b;\n}\n\n// Function Expression\nvar sum = function(a, b) {\n  return a + b;\n}`</script></code-example><p>Оба этих объявления говорят интерпретатору: "объяви переменную <code>sum</code>, создай функцию с указанными параметрами и кодом и сохрани её в <code>sum</code>".</p><p><strong>Основное отличие между ними: функции, объявленные как Function Declaration, создаются интерпретатором до выполнения кода.</strong></p><p>Поэтому их можно вызвать <em>до</em> объявления, например:</p><code-example><script>`MARKsayHi('Вася'); // Привет, Вася\n\nfunction sayHi(name) {\n  alert( 'Привет,&nbsp' + name );\n}`</script><code-toolbar></code-toolbar></code-example><p>А если бы это было объявление Function Expression, то такой вызов бы не сработал:</p><code-example><script>`MARKsayHi("Вася"); // ошибка!\n\nvar sayHi = function(name) {\n  alert( "Привет,&nbsp" + name );\n}`</script><code-toolbar></code-toolbar></code-example><p>Это из-за того, что JavaScript перед запуском кода ищет в нём Function Declaration (их легко найти: они не являются частью выражений и начинаются со слова <code>function</code>) и обрабатывает их.</p><p>А Function Expression создаются в процессе выполнения выражения, в котором созданы, в данном случае – функция будет создана при операции присваивания <code>sayHi = function...</code></p><p>Как правило, возможность Function Declaration вызвать функцию до объявления – это удобно, так как даёт больше свободы в том, как  организовать свой код.</p><p>Можно расположить функции внизу, а их вызов – сверху или наоборот.</p><h3><a name="5" href="#5">Условное объявление функции</a></h3><p>В некоторых случаях «дополнительное удобство» Function Declaration может сослужить плохую службу.</p><p>Например, попробуем, в зависимости от условия, объявить функцию <code>sayHi</code> по-разному:</p><code-example><script>`var age = +prompt('Сколько вам лет?', 20);\n\nif (age >= 18) {\n  function sayHi() {\n    alert( 'Прошу вас!' );\n  }\n} else {\n  function sayHi() {\n    alert( 'До 18 нельзя' );\n  }\n}\n\nsayHi();`</script><code-toolbar></code-toolbar></code-example><p>Function Declaration при <code>use strict</code> видны только внутри блока, в котором объявлены. Так как код в учебнике выполняется в режиме <code>use strict</code>, то будет ошибка.</p><p>А что, если использовать Function Expression?</p><code-example><script>`var age = prompt('Сколько вам лет?');\n\nvar sayHi;\n\nif (age >= 18) {\n  sayHi = function() {\n    alert( 'Прошу Вас!' );\n  }\n} else {\n  sayHi = function() {\n    alert( 'До 18 нельзя' );\n  }\n}\n\nsayHi();`</script><code-toolbar></code-toolbar></code-example><p>Или даже так:</p><code-example><script>`var age = prompt('Сколько вам лет?');\n\nvar sayHi = (age >= 18) ?\n  function() { alert('Прошу Вас!');  } :\n  function() { alert('До 18 нельзя'); };\n\nsayHi();`</script><code-toolbar></code-toolbar></code-example><p>Оба этих варианта работают правильно, поскольку, в зависимости от условия, создаётся именно та функция, которая нужна.</p><h3><a name="6" href="#6">Анонимные функции</a></h3><p>Взглянем ещё на один пример – функцию <code>ask(question, yes, no)</code> с тремя параметрами:</p><dl><dt><code>question</code></dt><dd>Строка-вопрос</dd><dt><code>yes</code></dt><dd style="
    margin: 5px 0 20px;
">Функция</dd><dt><code>no</code></dt><dd>Функция</dd></dl><p>Она выводит вопрос на подтверждение <code>question</code> и, в зависимости от согласия пользователя, вызывает функцию <code>yes()</code> или <code>no()</code>:</p><code-example><script>`MARKfunction ask(question, yes, no) {\nMARK    if (confirm(question)) yes()\nMARK    else no();\nMARK  }\n\nfunction showOk() {\n  alert( "Вы согласились." );\n}\n\nfunction showCancel() {\n  alert( "Вы отменили выполнение." );\n}\n\n// использование\nask("Вы согласны?", showOk, showCancel);`</script><code-toolbar></code-toolbar></code-example><p>Какой-то очень простой код, не правда ли? Зачем, вообще, может понадобиться такая <code>ask</code>?</p><p>…Оказывается, при работе со страницей такие функции как раз очень востребованы, только вот спрашивают они не простым <code>confirm</code>, а выводят более красивое окно с вопросом и могут интеллектуально обработать ввод посетителя. Но это всё потом, когда перейдём к работе с интерфейсом.</p><p>Здесь же обратим внимание на то, что то же самое можно написать более коротко:</p><code-example><script>`function ask(question, yes, no) {\n  if (confirm(question)) yes()\n  else no();\n}\n\nMARKask(\nMARK  "Вы согласны?",\nMARK  function() { alert("Вы согласились"); },\nMARK  function() { alert("Вы отменили выполнение"); }\n);`</script><code-toolbar></code-toolbar></code-example><p>Здесь функции объявлены прямо внутри вызова <code>ask(...)</code>, даже без присвоения им имени.</p><p><strong>Функциональное выражение, которое не записывается в переменную, называют <a href="http://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%BE%D0%BD%D0%B8%D0%BC%D0%BD%D0%B0%D1%8F_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F">анонимной функцией</a>.</strong></p><p>Действительно, зачем нам записывать функцию в переменную, если мы не собираемся вызывать её ещё раз? Можно просто объявить непосредственно там, где функция нужна.</p><p>Такого рода код возникает естественно, он соответствует «духу» JavaScript.</p><h2><a name="2" href="#2">new Function</a></h2><p>Существует ещё один способ создания функции, который используется очень редко, но упомянем и его для полноты картины.</p><p>Он позволяет создавать функцию полностью «на лету» из строки, вот так:</p><code-example><script>`var sum = new Function('a,b', ' return a+b;&nbsp');\n\nvar result = sum(1, 2);\nalert( result ); // 3`</script><code-toolbar></code-toolbar></code-example><p>То есть, функция создаётся вызовом <code>new Function(params, code)</code>:</p><dl><dt><code>params</code></dt><dd>Параметры функции через запятую в виде строки.</dd><dt><code>code</code></dt><dd>Код функции в виде строки.</dd></dl><p>Таким образом можно конструировать функцию, код которой неизвестен на момент написания программы, но строка с ним генерируется или подгружается динамически во время её выполнения.</p><p>Пример использования – динамическая компиляция шаблонов на JavaScript, мы встретимся с ней позже, при работе с интерфейсами.</p><h2><a name="3" href="#3">Итого</a></h2><p>Функции в JavaScript являются значениями. Их можно присваивать, передавать, создавать в любом месте кода.</p><ul><li>Если функция объявлена в <em>основном потоке кода</em>, то это Function Declaration.</li><li>Если функция создана как <em>часть выражения</em>, то это Function Expression.</li></ul><p>Между этими двумя основными способами создания функций есть следующие различия:</p><table><tbody><tr><th></th><th>Function Declaration</th><th>Function Expression</th></tr><tr><td>Время создания</td><td>До выполнения первой строчки кода.</td><td>Когда управление достигает строки с функцией.</td></tr><tr><td>Можно вызвать до объявления </td><td><code>Да</code> (т.к. создаётся заранее)</td><td><code>Нет</code></td></tr><tr><td>Условное объявление в <code>if</code></td><td><code>Не работает</code></td><td><code>Работает</code></td></tr></tbody></table><p>Иногда в коде начинающих разработчиков можно увидеть много Function Expression. Почему-то, видимо, не очень понимая происходящее, функции решают создавать как <code>var func = function()</code>, но в большинстве случаев обычное объявление функции – лучше.</p><p><strong>Если нет явной причины использовать Function Expression – предпочитайте Function Declaration.</strong></p><p>Сравните по читаемости:</p><code-example><script>`// Function Expression\nvar f = function() { ... }\n\n// Function Declaration\nfunction f() { ... }`</script></code-example><p>Function Declaration короче и лучше читается. Дополнительный бонус – такие функции можно вызывать до того, как они объявлены.</p><p>Используйте Function Expression только там, где это действительно нужно и удобно.</p><banner-bottom class="banner-bottom" style="display: block;"></banner-bottom><script>!function () { /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || screen.width < 1024 || "bannerBottomDisabled" in localStorage || (localStorage.bannerBottomShownCount || (localStorage.bannerBottomShownCount = 1), document.querySelector(".banner-bottom").style.display = "block") }();</script><nav-book data-tooltips="Функции; Рекурсия, стек"></nav-book><share-map><share-></share-><map-button hover-style="" data-load_page="l"></map-button></share-map><comments- id="comments"></comments-><div id="disqus_thread"></div><script>disqus_url = "https:\/\/learn.javascript.ru\/function-declaration-expression", disqus_identifier = "function-declaration-expression", disqus_title = "\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f";</script></page-content></main>