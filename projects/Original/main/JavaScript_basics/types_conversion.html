<main><page-content><nav-up><home- data-load_page="0" hover-style=""></home-><arrow-next></arrow-next><a data-load_page="1">Язык JavaScript</a><arrow-next></arrow-next><a data-load_page="7">Основы JavaScript</a></nav-up><h1>Преобразование типов для примитивов</h1><p>Система преобразования типов в JavaScript очень проста, но отличается от других языков. Поэтому она часто служит «камнем преткновения» для приходящих из других языков программистов.</p><p>Всего есть три преобразования:</p><ol><li>Строковое преобразование.</li><li>Численное преобразование.</li><li>Преобразование к логическому значению.</li></ol><p><strong>Эта глава описывает преобразование только примитивных значений, объекты разбираются далее.</strong></p><h2><a name="0" href="#0">Строковое преобразование</a></h2><p>Строковое преобразование происходит, когда требуется представление чего-либо в виде строки. Например, его производит функция <code>alert</code>.</p><code-example><script>`var a = true;\n\nalert( a ); // "true"`</script><code-toolbar></code-toolbar></code-example><p>Можно также осуществить преобразование явным вызовом <code>String(val)</code>:</p><code-example><script>`alert( String(null) === "null" );`</script><code-toolbar></code-toolbar></code-example><p>Как видно из примеров выше, преобразование происходит наиболее очевидным способом, «как есть»: <code>false</code> становится <code>"false"</code>, <code>null</code> – <code>"null"</code>, <code>undefined</code> – <code>"undefined"</code> и т.п.</p><p>Также для явного преобразования применяется оператор <code>"+"</code>, у которого один из аргументов строка. В этом случае он приводит к строке и другой аргумент, например:</p><code-example><script>`alert( true + "test" ); // "truetest"\nalert( "123" + undefined ); // "123undefined"`</script><code-toolbar></code-toolbar></code-example><h2><a name="1" href="#1">Численное преобразование</a></h2><p>Численное преобразование происходит в математических функциях и выражениях, а также при сравнении данных различных типов (кроме сравнений <code>===</code>, <code>!==</code>).</p><p>Для преобразования к числу в явном виде можно вызвать <code>Number(val)</code>, либо, что короче, поставить перед выражением унарный плюс <code>"+"</code>:</p><code-example><script>`var a = +"123"; // 123\nvar a = Number("123"); // 123, тот же эффект`</script></code-example><table><thead><tr><th>Значение</th><th>Преобразуется в...</th></tr></thead><tbody><tr><td><code>undefined</code></td><td><code>NaN</code></td></tr><tr><td><code>null</code></td><td><code>0</code></td></tr><tr><td><code>true / false</code></td><td><code>1 / 0</code></td></tr><tr><td>Строка</td><td>Пробельные символы по краям обрезаются.<br>Далее, если остаётся пустая строка, то <code>0</code>, иначе из непустой строки "считывается" число, при ошибке результат <code>NaN</code>.</td></tr></tbody></table><p>Например:</p><code-example><script>`// после обрезания пробельных символов останется "123"\nalert( +GREEN_"   GREEN_\\n  123   \\n  \\n" ); // 123`</script><code-toolbar></code-toolbar></code-example><p>Ещё примеры:</p><ul><li><p>Логические значения:</p><code-example><script>`alert( +true ); // 1\nalert( +false ); // 0`</script><code-toolbar></code-toolbar></code-example></li><li><p>Сравнение разных типов – значит численное преобразование:</p><code-example><script>`alert( "\\n0&nbsp" == 0 ); // true`</script><code-toolbar></code-toolbar></code-example><p>При этом строка <code>"\n0"</code> преобразуется к числу, как указано выше: начальные и конечные пробелы обрезаются, получается строка <code>"0"</code>, которая равна <code>0</code>.</p></li><li><p>С логическими значениями:</p><code-example><script>`alert( "\\n" == false );\nalert( "1" == true );`</script><code-toolbar></code-toolbar></code-example><p>Здесь сравнение <code>"=="</code> снова приводит обе части к числу. В первой строке слева и справа получается <code>0</code>, во второй <code>1</code>.</p></li></ul><h3><a name="6" href="#6">Специальные значения</a></h3><p>Посмотрим на поведение специальных значений более внимательно.</p><p><strong>Интуитивно, значения <code>null/undefined</code> ассоциируются с нулём, но при преобразованиях ведут себя иначе.</strong></p><p>Специальные значения преобразуются к числу так:</p><table><tbody><tr><th>Значение</th><th>Преобразуется в...</th></tr><tr><td><code>undefined</code></td><td><code>NaN</code></td></tr><tr><td><code>null</code></td><td><code>0</code></td></tr></tbody></table><p>Это преобразование осуществляется при арифметических операциях и сравнениях <code>&gt; &gt;= &lt; &lt;=</code>, но не при проверке равенства <code>==</code>. Алгоритм проверки равенства для этих значений в спецификации прописан отдельно (пункт <a href="http://es5.github.com/x11.html#x11.9.3">11.9.3</a>). В нём считается, что <code>null</code> и <code>undefined</code> равны <code>"=="</code> между собой, но эти значения не равны никакому другому значению.</p><p>Это ведёт к забавным последствиям.</p><p>Например, <code>null</code> не подчиняется законам математики – он «больше либо равен нулю»: <code>null&gt;=0</code>, но не больше и не равен:</p><code-example><script>`alert( null >= 0 ); // true, т.к. null преобразуется к 0\nalert( null > 0 ); // false (не больше), т.к. null преобразуется к 0\nalert( null == 0 ); // false (и не равен!), т.к. == рассматривает null особо.`</script><code-toolbar></code-toolbar></code-example><p>Значение <code>undefined</code> вообще «несравнимо»:</p><code-example><script>`alert( undefined > 0 ); // false, т.к. undefined -> NaN\nalert( undefined == 0 ); // false, т.к. это undefined (без преобразования)\nalert( undefined < 0 ); // false, т.к. undefined -> NaN`</script><code-toolbar></code-toolbar></code-example><p><strong>Для более очевидной работы кода и во избежание ошибок лучше не давать специальным значениям участвовать в сравнениях <code>&gt; &gt;= &lt; &lt;=</code>.</strong></p><p>Используйте в таких случаях переменные-числа или приводите к числу явно.</p><h2><a name="2" href="#2">Логическое преобразование</a></h2><p>Преобразование к <code>true/false</code> происходит в логическом контексте, таком как <code>if(value)</code>, и при применении логических операторов.</p><p>Все значения, которые интуитивно «пусты», становятся <code>false</code>. Их несколько: <code>0</code>, пустая строка, <code>null</code>, <code>undefined</code> и <code>NaN</code>.</p><p>Остальное, в том числе и любые объекты – <code>true</code>.</p><p>Полная таблица преобразований:</p><table><tbody><tr><th>Значение</th><th>Преобразуется в...</th></tr><tr><td><code>undefined</code>, <code>null</code></td><td><code>false</code></td></tr><tr><td>Числа</td><td>Все <code>true</code>, кроме <code>0</code>, <code>NaN</code> -- <code>false</code>.</td></tr><tr><td>Строки</td><td>Все <code>true</code>, кроме пустой строки <code>""</code> -- <code>false</code></td></tr><tr><td>Объекты</td><td>Всегда <code>true</code></td></tr></tbody></table><p><strong>Для явного преобразования используется двойное логическое отрицание <code>!!value</code> или вызов <code>Boolean(value)</code>.</strong></p><important-warn><h3>Обратите внимание: строка <code>"0"</code> становится <code>true</code></h3><p>В отличие от многих языков программирования (например PHP), <code>"0"</code> в JavaScript является <code>true</code>, как и строка из пробелов:</p><code-example><script>`alert( !!"0" ); // true\nalert( !!"&nbsp" ); // любые непустые строки, даже из пробелов - true!`</script><code-toolbar></code-toolbar></code-example></important-warn><p>Логическое преобразование интересно тем, как оно сочетается с численным.</p><p><strong>Два значения могут быть равны, но одно из них в логическом контексте <code>true</code>, другое – <code>false</code></strong>.</p><p>Например, равенство в следующем примере верно, так как происходит численное преобразование:</p><code-example><script>`alert( 0 == "\\n0\\n" ); // true`</script><code-toolbar></code-toolbar></code-example><p>… А в логическом контексте левая часть (0) даст <code>false</code>, правая ("\n0\n") – <code>true</code>, так как любая не пустая строка в логическом контексте равна <code>true</code>:</p><code-example><script>`if ("\\n0\\n") {\n  alert( "true, совсем не как 0!" );\n}`</script><code-toolbar></code-toolbar></code-example><p>С точки зрения преобразования типов в JavaScript это совершенно нормально. При сравнении с помощью «==» – численное преобразование, а в <code>if</code> – логическое, только и всего.</p><h2><a name="3" href="#3">Итого</a></h2><p>В JavaScript есть три преобразования:</p><ol><li>Строковое: <code>String(value)</code> – в строковом контексте или при сложении со строкой. Работает очевидным образом.</li><li>Численное: <code>Number(value)</code> – в численном контексте, включая унарный плюс <code>+value</code>. Происходит при сравнении разных типов, кроме строгого равенства.</li><li>Логическое: <code>Boolean(value)</code> – в логическом контексте, можно также сделать двойным НЕ: <code>!!value</code>.</li></ol><p>Точные таблицы преобразований даны выше в этой главе.</p><p>Особым случаем является проверка равенства с <code>null</code> и <code>undefined</code>. Они равны друг другу, но не равны чему бы то ни было ещё, этот случай прописан особо в спецификации.</p><h2 id="tasks"><a href="#4" name="4">Задачи (1)</a></h2><task-content><h3><a href="#8" name="8">Вопросник по преобразованиям, для примитивов</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 5</span><p>Подумайте, какой результат будет у выражений ниже. Тут не только преобразования типов. Когда закончите – сверьтесь с решением.</p><code-example><script>` "" + 1 + 0\n "" - 1 + 0\n true + false\n 6 / "3"\n "2" * "3"\n 4 + 5 + "px"\n "$" + 4 + 5\n\n "4" - 2\n\n "4px" - 2\n\n 7 / 0\n\n "  -9\\n" + 5\n "  -9\\n" - 5\n 5 && 2\n\n 2 && 5\n\n 5 || 0\n\n 0 || 5\n null + 1\n undefined + 1\n null == "\\n0\\n"\n +null == +"\\n0\\n"`</script></code-example><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><code-example><script>` "" + 1 + 0 = "10" // (1)\n "" - 1 + 0 = -1 // (2)\n true + false = 1\n 6 / "3" = 2\n "2" * "3" = 6\n 4 + 5 + "px" = "9px"\n "$" + 4 + 5\n  = "$45"\n "4" - 2\n  = 2\n "4px" - 2\n  = NaN\n 7 / 0\n  = Infinity\n " -9\\n" + 5 = " -9\\n5"\n " -9\\n" - 5 = -14\n 5 && 2\n  = 2\n 2 && 5\n  = 5\n 5 || 0\n  = 5\n 0 || 5 = 5\n null + 1 = 1 // (3)\n undefined + 1 = NaN // (4)\n null == "\\n0\\n" = false // (5)\n +null == +"\\n0\\n" = true // (6)`</script></code-example><ol><li>Оператор <code>"+"</code> в данном случае прибавляет <code>1</code> как строку, и затем <code>0</code>.</li><li>Оператор <code>"-"</code> работает только с числами, так что он сразу приводит <code>""</code> к <code>0</code>.</li><li><code>null</code> при численном преобразовании становится <code>0</code></li><li><code>undefined</code> при численном преобразовании становится <code>NaN</code></li><li>При сравнении <code>==</code> с <code>null</code> преобразования не происходит, есть жёсткое правило: <code>null == undefined</code> и только.</li><li>И левая и правая часть <code>==</code> преобразуются к числу <code>0</code>.</li></ol></task-answer></task-content><banner-bottom class="banner-bottom" style="display: block;"></banner-bottom><script>! function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||screen.width<1024||"bannerBottomDisabled" in localStorage||(localStorage.bannerBottomShownCount||(localStorage.bannerBottomShownCount=1),document.querySelector(".banner-bottom").style.display="block")}();</script><nav-book data-tooltips="Логические операторы; Циклы while, for"></nav-book><share-map><share-></share-><map-button hover-style="" data-load_page="l"></map-button></share-map><comments- id="comments"></comments-><div id="disqus_thread"></div><script>disqus_url="https:\/\/learn.javascript.ru\/types-conversion",disqus_identifier="types-conversion",disqus_title="\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0438\u043f\u043e\u0432 \u0434\u043b\u044f \u043f\u0440\u0438\u043c\u0438\u0442\u0438\u0432\u043e\u0432";</script></page-content></main>