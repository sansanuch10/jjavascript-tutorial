<main><page-content><nav-up><home- data-load_page="0" hover-style=""></home-><arrow-next></arrow-next><a data-load_page="1">Язык JavaScript</a><arrow-next></arrow-next><a data-load_page="7">Основы JavaScript</a></nav-up><h1>Функции</h1><p>Зачастую нам надо повторять одно и то же действие во многих частях программы.</p><p>Например, красиво вывести сообщение необходимо при приветствии посетителя, при выходе посетителя с сайта, ещё где-нибудь.</p><p>Чтобы не повторять один и тот же код во многих местах, придуманы функции. Функции являются основными «строительными блоками» программы.</p><p>Примеры встроенных функций вы уже видели – это <code>alert(message)</code>, <code>prompt(message, default)</code> и <code>confirm(question)</code>. Но можно создавать и свои.</p><h2><a name="0" href="#0">Объявление</a></h2><p>Пример объявления функции:</p><code-example><script>`function showMessage() {\n  alert( 'Привет всем присутствующим!' );\n}`</script></code-example><p>Вначале идет ключевое слово <code>function</code>, после него <em>имя функции</em>, затем <em>список параметров</em> в скобках (в примере выше он пустой) и <em>тело функции</em> – код, который выполняется при её вызове.</p><p>Объявленная функция доступна по имени, например:</p><code-example><script>`function showMessage() {\n  alert( 'Привет всем присутствующим!' );\n}\n\nMARKshowMessage();\nMARKshowMessage();`</script><code-toolbar></code-toolbar></code-example><p>Этот код выведет сообщение два раза. Уже здесь видна <strong>главная цель создания функций: избавление от дублирования кода</strong>.</p><p>Если понадобится поменять сообщение или способ его вывода – достаточно изменить его в одном месте: в функции, которая его выводит.</p><h2><a name="1" href="#1">Локальные переменные</a></h2><p>Функция может содержать <em>локальные</em> переменные, объявленные через <code>var</code>. Такие переменные видны только внутри функции:</p><code-example><script>`function showMessage() {\nMARK  var message = 'Привет, я - Вася!'; // локальная переменная\n\n  alert( message );\n}\n\nshowMessage(); // 'Привет, я - Вася!'\n\nalert( message ); // <-- будет ошибка, т.к. переменная видна только внутри`</script><code-toolbar></code-toolbar></code-example><p><strong>Блоки <code>if/else</code>, <code>switch</code>, <code>for</code>, <code>while</code>, <code>do..while</code> не влияют на область видимости переменных.</strong></p><p>При объявлении переменной в таких блоках, она всё равно будет видна во всей функции.</p><p>Например:</p><code-example><script>`+function count() {\n  // переменные i,j не будут уничтожены по окончании цикла\n  for (HIGHvarLIGHT i = 0; i < 3; i++) {\n    HIGHvarLIGHT j = i * 2;\n  }\n\nMARK  alert( i ); // i=3, последнее значение i, при нём цикл перестал работать\nMARK  alert( j ); // j=4, последнее значение j, которое вычислил цикл\n}()`</script><code-toolbar></code-toolbar></code-example><p><strong>Неважно, где именно в функции и сколько раз объявляется переменная. Любое объявление срабатывает один раз и распространяется на всю функцию.</strong></p><p>Объявления переменных в примере выше можно передвинуть вверх, это ни на что не повлияет:</p><code-example><script>`!function count() {\nMARK  var i, j; // передвинули объявления var в начало\n  for (i = 0; i < 3; i++) {\n    j = i * 2;\n  }\n\n  alert( i ); // i=3\n  alert( j ); // j=4\n}()`</script><code-toolbar></code-toolbar></code-example><h2><a name="2" href="#2">Внешние переменные</a></h2><p>Функция может обратиться ко внешней переменной, например:</p><code-example><script>`var userName = 'Вася';\n\nfunction showMessage() {\n  var message = 'Привет, я&nbsp' + userName;\n  alert(message);\n}\n\nshowMessage(); // Привет, я Вася`</script><code-toolbar></code-toolbar></code-example><p>Доступ возможен не только на чтение, но и на запись. При этом, так как переменная внешняя, то изменения будут видны и снаружи функции:</p><code-example><script>`var userName = 'Вася';\n\nfunction showMessage() {\n  userName = 'Петя'; // (1) присвоение во внешнюю переменную\n\n  var message = 'Привет, я&nbsp' + userName;\n  alert( message );\n}\n\nshowMessage();\n\nalert( userName ); // Петя, значение внешней переменной изменено функцией`</script><code-toolbar></code-toolbar></code-example><p>Конечно, если бы внутри функции, в строке <code>(1)</code>, была бы объявлена своя локальная переменная <code>var userName</code>, то все обращения использовали бы её, и внешняя переменная осталась бы неизменной.</p><p><strong>Переменные, объявленные на уровне всего скрипта, называют <em>«глобальными переменными»</em>.</strong></p><p>В примере выше переменная <code>userName</code> – глобальная.</p><p>Делайте глобальными только те переменные, которые действительно имеют общее значение для вашего проекта, а нужные для решения конкретной задачи – пусть будут локальными в соответствующей функции.</p><important-warn><h3>Внимание: неявное объявление глобальных переменных!</h3><p>В старом стандарте JavaScript существовала возможность неявного объявления переменных присвоением значения.</p><p>Например:</p><code-example><script>`function showMessage() {\n  message = 'Привет'; // без var!\n}\n\nshowMessage();\n\nalert( message ); // Привет`</script><code-toolbar></code-toolbar></code-example><p>В коде выше переменная <code>message</code> нигде не объявлена, а сразу присваивается. Скорее всего, программист просто забыл поставить <code>var</code>.</p><p>При <code>use strict</code> такой код привёл бы к ошибке, но без него переменная будет создана автоматически, причём в примере выше она создаётся не в функции, а на уровне всего скрипта.</p><p>Избегайте этого.</p><p>Здесь опасность даже не в автоматическом создании переменной, а в том, что глобальные переменные должны использоваться тогда, когда действительно нужны «общескриптовые» параметры.</p><p>Забыли <code>var</code> в одном месте, потом в другом – в результате одна функция неожиданно поменяла глобальную переменную, которую использует другая. И поди разберись, кто и когда её поменял, не самая приятная ошибка для отладки.</p></important-warn><p>В будущем, когда мы лучше познакомимся с основами JavaScript, в главе <a data-load_page="48">Замыкания, функции изнутри</a>, мы более детально рассмотрим внутренние механизмы работы переменных и функций.</p><h2><a name="3" href="#3">Параметры</a></h2><p>При вызове функции ей можно передать данные, которые та использует по своему усмотрению.</p><p>Например, этот код выводит два сообщения:</p><code-example><script>`function showMessage(HIGHfrom, textLIGHT) { // параметры from, text\n\n  from = '**&nbsp' + from + ' **'; // здесь может быть сложный код оформления\n\n  alert(from + ':&nbsp' + text);\n}\n\nMARKshowMessage('Маша', 'Привет!');\nMARKshowMessage('Маша', 'Как дела?');`</script><code-toolbar></code-toolbar></code-example><p><strong>Параметры копируются в локальные переменные функции</strong>.</p><p>Например, в коде ниже есть внешняя переменная <code>from</code>, значение которой при запуске функции копируется в параметр функции с тем же именем. Далее функция работает уже с параметром:</p><code-example><script>`function showMessage(from, text) {\nMARK  from = '**' + from + '**'; // меняем локальную переменную from\n  alert( from + ':&nbsp' + text );\n}\n\nvar from = 'Маша';\n\nshowMessage(from, 'Привет');\n\nalert( from ); // старое значение from без изменений, в функции была изменена копия`</script><code-toolbar></code-toolbar></code-example><h2><a name="4" href="#4">Аргументы по умолчанию</a></h2><p>Функцию можно вызвать с любым количеством аргументов.</p><p>Если параметр не передан при вызове – он считается равным <code>undefined</code>.</p><p>Например, функцию показа сообщения <code>showMessage(from, text)</code> можно вызвать с одним аргументом:</p><code-example><script>`showMessage("Маша");`</script></code-example><p>При этом можно проверить, и если параметр не передан – присвоить ему значение «по умолчанию»:</p><code-example><script>`function showMessage(from, text) {\nMARK  if (text === undefined) {\nMARK    text = "текст не передан";\nMARK  }\n\n  alert( from + ":&nbsp" + text );\n}\n\nMARKshowMessage("Маша", "Привет!"); // Маша: Привет!\nMARKshowMessage("Маша"); // Маша: текст не передан`</script><code-toolbar></code-toolbar></code-example><p><strong>При объявлении функции необязательные аргументы, как правило, располагают в конце списка.</strong></p><p>Для указания значения «по умолчанию», то есть, такого, которое используется, если аргумент не указан, используется два способа:</p><ol><li><p>Можно проверить, равен ли аргумент <code>undefined</code>, и если да – то записать в него значение по умолчанию. Этот способ продемонстрирован в примере выше.</p></li><li><p>Использовать оператор <code>||</code>:</p><code-example><script>`function showMessage(from, text) {\n  text = text || 'текст не передан';\n\n  ...\n}`</script></code-example><p>Второй способ считает, что аргумент отсутствует, если передана пустая строка, <code>0</code>, или вообще любое значение, которое в логическом контексте является <code>false</code>.</p></li></ol><p>Если аргументов передано больше, чем надо, например <code>showMessage("Маша", "привет", 1, 2, 3)</code>, то ошибки не будет. Но, чтобы получить такие «лишние» аргументы, нужно будет прочитать их из специального объекта <code>arguments</code>, который мы рассмотрим в главе <a data-load_page="44">Псевдомассив аргументов "arguments"</a>.</p><h2><a name="5" href="#5">Возврат значения</a></h2><p>Функция может возвратить результат, который будет передан в вызвавший её код.</p><p>Например, создадим функцию <code>calcD</code>, которая будет возвращать дискриминант квадратного уравнения по формуле <code>b<sup>2</sup> – 4ac</code>:</p><code-example><script>`function calcD(a, b, c) {\n   HIGHreturnLIGHT b*b - 4*a*c;\n}\n\nvar test = calcD(-4, 2, 1);\nalert(test); // 20`</script><code-toolbar></code-toolbar></code-example><p><strong>Для возврата значения используется директива <code>return</code>.</strong></p><p>Она может находиться в любом месте функции. Как только до неё доходит управление – функция завершается и значение передается обратно.</p><p>Вызовов <code>return</code> может быть и несколько, например:</p><code-example><script>`function checkAge(age) {\n  if (age > 18) {\n    return true;\n  } else {\n    return confirm('Родители разрешили?');\n  }\n}\n\nvar age = prompt('Ваш возраст?');\n\nif (checkAge(age)) {\n  alert( 'Доступ разрешен' );\n} else {\n  alert( 'В доступе отказано' );\n}`</script><code-toolbar></code-toolbar></code-example><p>Директива <code>return</code> может также использоваться без значения, чтобы прекратить выполнение и выйти из функции.</p><p>Например:</p><code-example><script>`function showMovie(age) {\n  if (!checkAge(age)) {\nMARK    return;\n  }\n\n  alert( "Фильм не для всех" ); // (*)\n  // ...\n}`</script></code-example><p>В коде выше, если сработал <code>if</code>, то строка <code>(*)</code> и весь код под ней никогда не выполнится, так как <code>return</code> завершает выполнение функции.</p><important-><h3>Значение функции без <code>return</code> и с пустым <code>return</code></h3><p>В случае, когда функция не вернула значение или <code>return</code> был без аргументов, считается что она вернула <code>undefined</code>:</p><code-example><script>`function doNothing() { /* пусто */ }\n\nalert( doNothing() ); // undefined`</script><code-toolbar></code-toolbar></code-example><p>Обратите внимание, никакой ошибки нет. Просто возвращается <code>undefined</code>.</p><p>Ещё пример, на этот раз с <code>return</code> без аргумента:</p><code-example><script>`function doNothing() {\n  return;\n}\n\nalert( doNothing() === undefined ); // true`</script><code-toolbar></code-toolbar></code-example></important-><h2><a name="6" href="#6">Выбор имени функции</a></h2><p>Имя функции следует тем же правилам, что и имя переменной. Основное отличие – оно должно быть глаголом, т.к. функция – это действие.</p><p>Как правило, используются глагольные префиксы, обозначающие общий характер действия, после которых следует уточнение.</p><p>Функции, которые начинаются с <code>"show"</code> – что-то показывают:</p><code-example><script>`showMessage(..)     // префикс show, "показать" сообщение`</script></code-example><p>Функции, начинающиеся с <code>"get"</code> – получают, и т.п.:</p><code-example><script>`getAge(..)          // get, "получает" возраст\ncalcD(..)           // calc, "вычисляет" дискриминант\ncreateForm(..)      // create, "создает" форму\ncheckPermission(..) // check, "проверяет" разрешение, возвращает true/false`</script></code-example><p>Это очень удобно, поскольку взглянув на функцию – мы уже примерно представляем, что она делает, даже если функцию написал совсем другой человек, а в отдельных случаях – и какого вида значение она возвращает.</p><important-><h3>Одна функция – одно действие</h3><p>Функция должна делать только то, что явно подразумевается её названием. И это должно быть одно действие.</p><p>Если оно сложное и подразумевает поддействия – может быть имеет смысл выделить их в отдельные функции? Зачастую это имеет смысл, чтобы лучше структурировать код.</p><p><strong>…Но самое главное – в функции не должно быть ничего, кроме самого действия и поддействий, неразрывно связанных с ним.</strong></p><p>Например, функция проверки данных (скажем, <code>"validate"</code>) не должна показывать сообщение об ошибке. Её действие – проверить.</p></important-><important-><h3>Сверхкороткие имена функций</h3><p>Имена функций, которые используются <em>очень часто</em>, иногда делают сверхкороткими.</p><p>Например, во фреймворке <a href="http://jquery.com">jQuery</a> есть функция <code>$</code>, во фреймворке <a href="http://prototypejs.org/">Prototype</a> – функция <code>$$</code>, а в библиотеке <a href="http://lodash.com/">LoDash</a> очень активно используется функция с названием из одного символа подчеркивания <code>_</code>.</p></important-><h2><a name="7" href="#7">Итого</a></h2><p>Объявление функции имеет вид:</p><code-example><script>`function имя(параметры, через, запятую) {\n  код функции\n}`</script></code-example><ul><li>Передаваемые значения копируются в параметры функции и становятся локальными переменными.</li><li>Параметры функции копируются в её локальные переменные.</li><li>Можно объявить новые локальные переменные при помощи <code>var</code>.</li><li>Значение возвращается оператором <code>return ...</code>.</li><li>Вызов <code>return</code> тут же прекращает функцию.</li><li>Если <code>return;</code> вызван без значения, или функция завершилась без <code>return</code>, то её результат равен <code>undefined</code>.</li></ul><p>При обращении к необъявленной переменной функция будет искать внешнюю переменную с таким именем, но лучше, если функция использует только локальные переменные:</p><ul><li>Это делает очевидным общий поток выполнения – что передаётся в функцию и какой получаем результат.</li><li>Это предотвращает возможные конфликты доступа, когда две функции, возможно написанные в разное время или разными людьми, неожиданно друг для друга меняют одну и ту же внешнюю переменную.</li></ul><p>Именование функций:</p><ul><li>Имя функции должно понятно и чётко отражать, что она делает. Увидев её вызов в коде, вы должны тут же понимать, что она делает.</li><li>Функция – это действие, поэтому для имён функций, как правило, используются глаголы.</li></ul><p>Функции являются основными строительными блоками скриптов. Мы будем неоднократно возвращаться к ним и изучать все более и более глубоко.</p><h2 id="tasks"><a href="#8" name="8">Задачи (4)</a></h2><task-content><h3><a href="#14" name="14">Обязателен ли "else"?</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 4</span><p>Следующая функция возвращает <code>true</code>, если параметр <code>age</code> больше <code>18</code>.В ином случае она задаёт вопрос посредством вызова <code>confirm</code> и возвращает его результат.</p><code-example><script>`function checkAge(age) {\n  if (age > 18) {\n    return true;\nMARK  } else {\nMARK    // ...\nMARK    return confirm('Родители разрешили?');\nMARK  }\n}`</script></code-example><p>Будет ли эта функция работать как-то иначе, если убрать <code>else</code>?</p><code-example><script>`function checkAge(age) {\n  if (age > 18) {\n    return true;\n  }\nMARK  // ...\nMARK  return confirm('Родители разрешили?');\n}`</script></code-example><p>Есть ли хоть одно отличие в поведении этого варианта?</p><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer style=""><close- title="закрыть" data-close_answer=""></close-><p>Оба варианта функции работают одинаково, отличий нет.</p></task-answer></task-content><task-content><h3><a href="#15" name="15">Перепишите функцию, используя оператор '?' или '||'</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 4</span><p>Следующая функция возвращает <code>true</code>, если параметр <code>age</code> больше <code>18</code>.В ином случае она задаёт вопрос <code>confirm</code> и возвращает его результат.</p><code-example><script>`function checkAge(age) {\n  if (age > 18) {\n    return true;\n  } else {\n    return confirm('Родители разрешили?');\n  }\n}`</script></code-example><p>Перепишите функцию, чтобы она делала то же самое, но без <code>if</code>, в одну строку.Сделайте два варианта функции <code>checkAge</code>:</p><ol><li>Используя оператор <code>'?'</code></li><li>Используя оператор <code>||</code></li></ol><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><p>Используя оператор <code>'?'</code>:</p><code-example><script>`function checkAge(age) {\n  return (age > 18) ? true : confirm('Родители разрешили?');\n}`</script></code-example><p>Используя оператор <code>||</code> (самый короткий вариант):</p><code-example><script>`function checkAge(age) {\n  return (age > 18) || confirm('Родители разрешили?');\n}`</script></code-example></task-answer></task-content><task-content><h3><a href="#16" name="16">Функция min</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 1</span><p>Задача «Hello World» для функций :)</p><p>Напишите функцию <code>min(a,b)</code>, которая возвращает меньшее из чисел <code>a,b</code>.</p><p>Пример вызовов:</p><code-example><script>`min(2, 5) == 2\nmin(3, -1) == -1\nmin(1, 1) == 1`</script></code-example><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><p>Вариант решения с использованием <code>if</code>:</p><code-example><script>`function min(a, b) {\n  if (a < b) {\n    return a;\n  } else {\n    return b;\n  }\n}`</script></code-example><p>Вариант решения с оператором <code>'?'</code>:</p><code-example><script>`function min(a, b) {\n  return a < b ? a : b;\n}`</script></code-example><p>P.S. Случай равенства <code>a == b</code> здесь отдельно не рассматривается, так как при этом неважно, что возвращать.</p></task-answer></task-content><task-content><h3><a href="#17" name="17">Функция pow(x,n)</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 4</span><p>Напишите функцию <code>pow(x,n)</code>, которая возвращает <code>x</code> в степени <code>n</code>. Иначе говоря, умножает <code>x</code> на себя <code>n</code> раз и возвращает результат.</p><code-example><script>`pow(3, 2) = 3 * 3 = 9\npow(3, 3) = 3 * 3 * 3 = 27\npow(1, 100) = 1 * 1 * ...*1 = 1`</script></code-example><p>Создайте страницу, которая запрашивает <code>x</code> и <code>n</code>, а затем выводит результат <code>pow(x,n)</code>.</p><p><a data-run_demo="">Запустить демо</a></p><p>P.S. В этой задаче функция обязана поддерживать только натуральные значения <code>n</code>, т.е. целые от <code>1</code> и выше.</p><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><code-example><script>`/**\nCOMMENT * Возводит x в степень n (комментарий JSDoc)\nCOMMENT *\nCOMMENT * @param {number} x число, которое возводится в степень\nCOMMENT * @param {number} n степень, должна быть целым числом больше 1\nCOMMENT *\nCOMMENT * @return {number} x в степени n\n */\nfunction pow(x, n) {\n  var result = x;\n\n  for (var i = 1; i < n; i++) {\n    result *= x;\n  }\n\n  return result;\n}\n\nvar x = prompt('x?', '');\nvar n = prompt('n?', '');\n\nif (n <= 1) {\n  alert('Степень&nbsp' + n +\n    'не поддерживается, введите целую степень, большую 1'\n  );\n} else {\n  alert( pow(x, n) );\n}`</script><code-toolbar></code-toolbar></code-example></task-answer></task-content><banner-bottom class="banner-bottom" style="display: block;"></banner-bottom><script>! function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||screen.width<1024||"bannerBottomDisabled" in localStorage||(localStorage.bannerBottomShownCount||(localStorage.bannerBottomShownCount=1),document.querySelector(".banner-bottom").style.display="block")}();</script><nav-book data-tooltips="Конструкция switch; Функциональные выражения"></nav-book><share-map><share-></share-><map-button hover-style="" data-load_page="l"></map-button></share-map><comments- id="comments"></comments-><div id="disqus_thread"></div><script>disqus_url="https:\/\/learn.javascript.ru\/function-basics",disqus_identifier="function-basics",disqus_title="\u0424\u0443\u043d\u043a\u0446\u0438\u0438";</script></page-content></main>