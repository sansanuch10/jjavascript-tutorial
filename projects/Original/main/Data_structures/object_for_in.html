<main><page-content><nav-up><home- data-load_page="0" hover-style=""></home-><arrow-next></arrow-next><a data-load_page="1">Язык JavaScript</a><arrow-next></arrow-next><a data-load_page="34">Структуры данных</a></nav-up><h1>Объекты: перебор свойств</h1><p>Для перебора всех свойств из объекта используется цикл по свойствам <code>for..in</code>. Эта синтаксическая конструкция отличается от рассмотренного ранее цикла <code>for(;;)</code>.</p><h2><a name="0" href="#0">for..in</a></h2><p>Синтаксис:</p><code-example><script>`for (key in obj) {\n  /* ... делать что-то с obj[key] ... */\n}`</script></code-example><p>При этом <code>for..in</code> последовательно переберёт свойства объекта <code>obj</code>, имя каждого свойства будет записано в <code>key</code> и вызвано тело цикла.</p><important-><h3>Объявление переменной в цикле <code>for (var key in obj)</code></h3><p>Вспомогательную переменную <code>key</code> можно объявить прямо в цикле:</p><code-example><script>`for (HIGHvar keyLIGHT in menu) {\n  // ...\n}`</script></code-example><p>Так иногда пишут для краткости кода. Можно использовать и любое другое название, кроме <code>key</code>, например <code>for(var propName in menu)</code>.</p></important-><p>Пример итерации по свойствам:</p><code-example><script>`var menu = {\n  width: 300,\n  height: 200,\n  BLUE_title_BLUE: "Menu"\n};\n\nfor (var key in menu) {\n  // этот код будет вызван для каждого свойства объекта\n  // ..и выведет имя свойства и его значение\n\nMARK  alert( "Ключ:&nbsp" + key + " значение:&nbsp" + menu[key] );\n}`</script><code-toolbar></code-toolbar></code-example><p>Обратите внимание, мы использовали квадратные скобки <code>menu[key]</code>. Как уже говорилось, если имя свойства хранится в переменной, то обратиться к нему можно только так, не через точку.</p><h2><a name="1" href="#1">Количество свойств в объекте</a></h2><p>Как узнать, сколько свойств хранит объект?</p><p>Готового метода для этого нет.</p><p>Самый кросс-браузерный способ – это сделать цикл по свойствам и посчитать, вот так:</p><code-example><script>`var menu = {\n  width: 300,\n  height: 200,\n  BLUE_title_BLUE: "Menu"\n};\n\nMARKvar counter = 0;\nMARK&nbsp\nMARKfor (var key in menu) {\nMARK  counter++;\nMARK}\n\nalert( "Всего свойств:&nbsp" + counter );`</script><code-toolbar></code-toolbar></code-example><p>В следующих главах мы пройдём массивы и познакомимся с другим, более коротким, вызовом: <code>Object.keys(menu).length</code>.</p><h2><a name="2" href="#2">В каком порядке перебираются свойства?</a></h2><p>Для примера, рассмотрим объект, который задаёт список опций для выбора страны:</p><code-example><script>`var codes = {\n  // телефонные коды в формате "код страны": "название"\n  "7": "Россия",\n  "38": "Украина",\n  // ..,\n  "1": "США"\n};`</script></code-example><p>Здесь мы предполагаем, что большинство посетителей из России, и поэтому начинаем с <code>7</code>, это зависит от проекта.</p><p>При выборе телефонного кода мы хотели бы предлагать варианты, начиная с первого. Обычно на основе списка генерируется <code>select</code>, но здесь нам важно не это, а важно другое.</p><p><strong>Правда ли, что при переборе <code>for(key in codes)</code> ключи <code>key</code> будут перечислены именно в том порядке, в котором заданы?</strong></p><p><strong>По стандарту – нет. Но некоторое соглашение об этом, всё же, есть.</strong></p><p>Соглашение говорит, что если имя свойства – нечисловая строка, то такие ключи всегда перебираются в том же порядке, в каком присваивались. Так получилось по историческим причинам и изменить это сложно: поломается много готового кода.</p><p>С другой стороны, если имя свойства – число или числовая строка, то все современные браузеры сортируют такие свойства в целях внутренней оптимизации.</p><p>К примеру, рассмотрим объект с заведомо нечисловыми свойствами:</p><code-example><script>`var user = {\n  name: "Вася",\n  surname: "Петров"\n};\nuser.age = 25;\n\nMARK// порядок перебора соответствует порядку присвоения свойства\nfor (var prop in user) {\n  alert( prop ); // name, surname, age\n}`</script><code-toolbar></code-toolbar></code-example><p>А теперь – что будет, если перебрать объект с кодами?</p><code-example><script>`var codes = {\n  // телефонные коды в формате "код страны": "название"\n  "7": "Россия",\n  "38": "Украина",\n  "1": "США"\n};\n\nfor (var code in codes) alert( code ); // 1, 7, 38`</script><code-toolbar></code-toolbar></code-example><p>При запуске этого кода в современном браузере мы увидим, что на первое место попал код США!</p><p>Нарушение порядка возникло, потому что ключи численные. Интерпретатор JavaScript видит, что строка на самом деле является числом и преобразует ключ в немного другой внутренний формат. Дополнительным эффектом внутренних оптимизаций является сортировка.</p><p><strong>А что, если мы хотим, чтобы порядок был именно таким, какой мы задали?</strong></p><p>Это возможно. Можно применить небольшой хак, который заключается в том, чтобы сделать все ключи нечисловыми, например, добавим в начало дополнительный символ <code>'+'</code>:</p><code-example><script>`var codes = {\n  "+7": "Россия",\n  "+38": "Украина",\n  "+1": "США"\n};\n\nfor (var code in codes) {\n  var value = codes[code];\n  code = +code; // ..если нам нужно именно число, преобразуем: "+7" -> 7\n\n  alert( code + ":&nbsp" + value ); // 7, 38, 1 во всех браузерах\n}`</script><code-toolbar></code-toolbar></code-example><h2><a name="3" href="#3">Итого</a></h2><ul><li>Цикл по ключам: <code>for (key in obj)</code>.</li><li>Порядок перебора соответствует порядку объявления для нечисловых ключей, а числовые – сортируются (в современных браузерах).</li><li>Если нужно, чтобы порядок перебора числовых ключей соответствовал их объявлению в объекте, то используют трюк: числовые ключи заменяют на похожие, но содержащие не только цифры. Например, добавляют в начало <code>+</code>, как описано в примере выше, а потом, в процессе обработки, преобразуют такие ключи в числа.</li></ul><h2 id="tasks"><a href="#4" name="4">Задачи (4)</a></h2><task-content><h3><a href="#7" name="7">Определите, пуст ли объект</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 5</span><p>Создайте функцию <code>isEmpty(obj)</code>, которая возвращает <code>true</code>, если в объекте нет свойств и <code>false</code> – если хоть одно свойство есть.</p><p>Работать должно так:</p><code-example><script>`function isEmpty(obj) {\n  /* ваш код */\n}\n\nvar schedule = {};\n\nalert( isEmpty(schedule) ); // true\n\nschedule["8:30"] = "подъём";\n\nalert( isEmpty(schedule) ); // false`</script></code-example><code-example style="display:none;"><script>`<!DOCTYPE html>\n<html>\n\n<head>\n  <meta charset="utf-8">\n  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.css">\n  <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.js"><\/script>\n  <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/2.0.0/chai.js"><\/script>\n  <script>var assert = chai.assert; mocha.setup("bdd");<\/script>\n</head>\n\n<body>\n\n  <script>\n    // ...Ваш код...\n  <\/script>\n  <script>\n    describe("isEmpty", function() {\n      it("если объект пустой - возвращает true", function() {\n        assert.isTrue(isEmpty({}));\n      });\n\n      it("если у объекта есть любое свойство, не важно какое - возвращает false", function() {\n        assert.isFalse(isEmpty({\n          anything: false\n        }));\n      });\n    });\n  <\/script>\n  <div id="mocha"></div>\n  <script>mocha.run();<\/script>\n</body>\n\n</html>`</script><code-toolbar-><a id="task_1" data-code_edit=""></a></code-toolbar-></code-example><p><a data-click="task_1">Открыть песочницу с тестами для задачи.</a></p><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><code-example><script>`function isEmpty(obj) {\n  for (var key in obj) {\n    return false;\n  }\n  return true;\n}\n\nvar schedule = {};\n\nalert( isEmpty(schedule) ); // true\n\nschedule["8:30"] = "подъём";\n\nalert( isEmpty(schedule) ); // false`</script><code-toolbar></code-toolbar></code-example><code-example style="display:none;"><script>`<!DOCTYPE html>\n<html>\n\n<head>\n  <meta charset="utf-8">\n  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.css">\n  <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.js"><\/script>\n  <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/2.0.0/chai.js"><\/script>\n  <script>var assert = chai.assert; mocha.setup("bdd");<\/script>\n</head>\n\n<body>\n\n  <script>\n     function isEmpty(obj) {\n       for (var key in obj) {\n         return false;\n       }\n       return true;\n     }\n  <\/script>\n  <script>\n    describe("isEmpty", function() {\n      it("если объект пустой - возвращает true", function() {\n        assert.isTrue(isEmpty({}));\n      });\n\n      it("если у объекта есть любое свойство, не важно какое - возвращает false", function() {\n        assert.isFalse(isEmpty({\n          anything: false\n        }));\n      });\n    });\n  <\/script>\n  <div id="mocha"></div>\n  <script>mocha.run();<\/script>\n</body>\n\n</html>`</script><code-toolbar-><a id="answer_1" data-code_edit=""></a></code-toolbar-></code-example><p><a data-click="answer_1">Открыть решение с тестами в песочнице.</a></p></task-answer></task-content><task-content><h3><a href="#8" name="8">Сумма свойств</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 5</span><p>Есть объект <code>salaries</code> с зарплатами. Напишите код, который выведет сумму всех зарплат.</p><p>Если объект пустой, то результат должен быть <code>0</code>.</p><p>Например:</p><code-example><script>`"use strict";\n\nvar salaries = {\n  "Вася": 100,\n  "Петя": 300,\n  "Даша": 250\n};\n\n//... ваш код выведет 650`</script></code-example><p>P.S. Сверху стоит <code>use strict</code>, чтобы не забыть объявить переменные.</p><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer style=""><close- title="закрыть" data-close_answer=""></close-><code-example><script>`"use strict";\n\nvar salaries = {\n  "Вася": 100,\n  "Петя": 300,\n  "Даша": 250\n};\n\nvar sum = 0;\nfor (var name in salaries) {\n  sum += salaries[name];\n}\n\nalert( sum );`</script><code-toolbar></code-toolbar></code-example></task-answer></task-content><task-content><h3><a href="#9" name="9">Свойство с наибольшим значением</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 5</span><p>Есть объект <code>salaries</code> с зарплатами. Напишите код, который выведет имя сотрудника, у которого самая большая зарплата.</p><p>Если объект пустой, то пусть он выводит «нет сотрудников».</p><p>Например:</p><code-example><script>`"use strict";\n\nvar salaries = {\n  "Вася": 100,\n  "Петя": 300,\n  "Даша": 250\n};\n\n// ... ваш код выведет "Петя"`</script></code-example><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer style=""><close- title="закрыть" data-close_answer=""></close-><code-example><script>`"use strict";\n\nvar salaries = {\n  "Вася": 100,\n  "Петя": 300,\n  "Даша": 250\n};\n\nvar max = 0;\nvar maxName = "";\nfor (var name in salaries) {\n  if (max < salaries[name]) {\n    max = salaries[name];\n    maxName = name;\n  }\n}\n\nalert( maxName || "нет сотрудников" );`</script><code-toolbar></code-toolbar></code-example></task-answer></task-content><task-content><h3><a href="#10" name="10">Умножьте численные свойства на 2</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 3</span><p>Создайте функцию <code>multiplyNumeric</code>, которая получает объект и умножает все численные свойства на 2. Например:</p><code-example><script>`// до вызова\nvar menu = {\n  width: 200,\n  height: 300,\n  BLUE_title_BLUE: "My menu"\n};\n\nmultiplyNumeric(menu);\n\n// после вызова\nmenu = {\n  width: 400,\n  height: 600,\n  BLUE_title_BLUE: "My menu"\n};`</script></code-example><p>P.S. Для проверки на число используйте функцию:</p><code-example><script>`function isNumeric(n) {\n  return !isNaN(parseFloat(n)) && isFinite(n)\n}`</script></code-example><code-example style="display:none;"><script>`<!DOCTYPE html>\n<html>\n\n<head>\n  <meta charset="utf-8">\n  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.css">\n  <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.js"><\/script>\n  <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/2.0.0/chai.js"><\/script>\n  <script>var assert = chai.assert; mocha.setup("bdd");<\/script>\n</head>\n\n<body>\n\n  <script>\n    // ...Ваш код...\n  <\/script>\n  <script>\n    describe("multiplyNumeric", function() {\n      it("multiplies all numeric properties by 2", function() {\n        var menu = {\n          width: 200,\n          height: 300,\n          title: "My menu"\n        };\n        let result = multiplyNumeric(menu);\n        assert.equal(menu.width, 400);\n        assert.equal(menu.height, 600);\n        assert.equal(menu.title, "My menu");\n      });\n\n      it("returns nothing", function() {\n        assert.isUndefined( multiplyNumeric({}) );\n      });\n    });\n  <\/script>\n  <div id="mocha"></div>\n  <script>mocha.run();<\/script>\n</body>\n\n</html>`</script><code-toolbar-><a id="task_4" data-code_edit=""></a></code-toolbar-></code-example><p><a data-click="task_4">Открыть песочницу с тестами для задачи.</a></p><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><code-example><script>`var menu = {\n  width: 200,\n  height: 300,\n  BLUE_title_BLUE: "My menu"\n};\n\nfunction isNumeric(n) {\n  return !isNaN(parseFloat(n)) && isFinite(n);\n}\n\nfunction multiplyNumeric(obj) {\n  for (var key in obj) {\n    if (isNumeric(obj[key])) {\n      obj[key] *= 2;\n    }\n  }\n}\n\nmultiplyNumeric(menu);\n\nalert( "menu width =&nbsp" + menu.width + "; height =&nbsp" + menu.height + "; title =&nbsp" + menu.title );`</script><code-toolbar></code-toolbar></code-example><code-example style="display:none;"><script>`<!DOCTYPE html>\n<html>\n\n<head>\n  <meta charset="utf-8">\n  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.css">\n  <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.js"><\/script>\n  <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/2.0.0/chai.js"><\/script>\n  <script>var assert = chai.assert; mocha.setup("bdd");<\/script>\n</head>\n\n<body>\n\n  <script>\n    function isNumeric(n) {\n      return !isNaN(parseFloat(n)) && isFinite(n)\n    }\n    \n    function multiplyNumeric(obj) {\n      for (var key in obj) {\n        if (isNumeric(obj[key])) {\n          obj[key] *= 2;\n        }\n      }\n    }\n  <\/script>\n  <script>\n    describe("multiplyNumeric", function() {\n      it("multiplies all numeric properties by 2", function() {\n        var menu = {\n          width: 200,\n          height: 300,\n          title: "My menu"\n        };\n        let result = multiplyNumeric(menu);\n        assert.equal(menu.width, 400);\n        assert.equal(menu.height, 600);\n        assert.equal(menu.title, "My menu");\n      });\n\n      it("returns nothing", function() {\n        assert.isUndefined( multiplyNumeric({}) );\n      });\n    });\n  <\/script>\n  <div id="mocha"></div>\n  <script>mocha.run();<\/script>\n</body>\n\n</html>`</script><code-toolbar-><a id="answer_4" data-code_edit=""></a></code-toolbar-></code-example><p><a data-click="answer_4">Открыть решение с тестами в песочнице.</a></p></task-answer></task-content><banner-bottom class="banner-bottom" style="display: block;"></banner-bottom><script>! function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||screen.width<1024||"bannerBottomDisabled" in localStorage||(localStorage.bannerBottomShownCount||(localStorage.bannerBottomShownCount=1),document.querySelector(".banner-bottom").style.display="block")}();</script><nav-book data-tooltips="Объекты как ассоциативные массивы; Объекты: передача по ссылке"></nav-book><share-map><share-></share-><map-button hover-style="" data-load_page="l"></map-button></share-map><comments- id="comments"></comments-><div id="disqus_thread"></div><script>disqus_url="https:\/\/learn.javascript.ru\/object-for-in",disqus_identifier="object-for-in",disqus_title="\u041e\u0431\u044a\u0435\u043a\u0442\u044b: \u043f\u0435\u0440\u0435\u0431\u043e\u0440 \u0441\u0432\u043e\u0439\u0441\u0442\u0432";</script></page-content></main>