var DragManager=new function(){var t={},e=this;document.onmousemove=function(e){if(t.elem){if(!t.avatar){var n=e.pageX-t.downX,a=e.pageY-t.downY;if(Math.abs(n)<3&&Math.abs(a)<3)return;if(t.avatar=(r=t.elem,l={parent:r.parentNode,nextSibling:r.nextSibling,position:r.position||"",left:r.left||"",top:r.top||"",zIndex:r.zIndex||""},r.rollback=function(){l.parent.insertBefore(r,l.nextSibling),r.style.position=l.position,r.style.left=l.left,r.style.top=l.top,r.style.zIndex=l.zIndex},r),!t.avatar)return void(t={});var o=getCoords(t.avatar);t.shiftX=t.downX-o.left,t.shiftY=t.downY-o.top,i=t.avatar,document.body.appendChild(i),i.style.zIndex=9999,i.style.position="absolute"}var i,r,l;return t.avatar.style.left=e.pageX-t.shiftX+"px",t.avatar.style.top=e.pageY-t.shiftY+"px",!1}},document.onmouseup=function(n){var a;t.avatar&&((a=function(e){t.avatar.hidden=!0;var n=document.elementFromPoint(e.clientX,e.clientY);return t.avatar.hidden=!1,null==n?null:n.closest("drop-able")}(n))?e.onDragEnd(t,a):e.onDragCancel(t)),t={}},document.onmousedown=function(e){if(1==e.which){var n=e.target.closest("img");if(n)return t.elem=n,t.downX=e.pageX,t.downY=e.pageY,!1}},this.onDragEnd=function(t,e){},this.onDragCancel=function(t){}};function getCoords(t){var e=t.getBoundingClientRect();return{top:e.top+pageYOffset,left:e.left+pageXOffset}}