<main><script>document.getElementById("getBoundingClientRectEx").onclick=function(e){var t=getOffsetSum(this),n=getCoords(this);if (null == e.pageX&&null != e.clientX){var l=document.documentElement,o=document.body;e.pageX=e.clientX+(l&&l.scrollLeft||o&&o.scrollLeft||0)-(l.clientLeft||0),e.pageY=e.clientY+(l&&l.scrollTop||o&&o.scrollTop||0)-(l.clientTop||0)}var c=document.getElementById("getBoundingClientRectExRes").getElementsByTagName("SPAN");c[0].innerHTML="{left:"+t.left+", top:"+t.top+"}",c[1].innerHTML="{left:"+n.left+", top:"+n.top+"}",c[2].innerHTML="pageX="+e.pageX+" pageY="+e.pageY};function getOffsetSum(t){for (var f=0,e=0;t;) f += parseInt(t.offsetTop),e += parseInt(t.offsetLeft),t=t.offsetParent;return{top:f,left:e}}function getCoords(t){var e=t.getBoundingClientRect();return{top:e.top+pageYOffset,left:e.left+pageXOffset}}</script><page-content><nav-up><home- data-load_page="0" hover-style=""></home-><arrow-next></arrow-next><a data-load_page="98">Документ, события, интерфейсы</a><arrow-next></arrow-next><a data-load_page="99">Документ и объекты страницы</a></nav-up><h1>Координаты в документе</h1><p><em>Система координат относительно страницы</em> или, иначе говоря, <em>относительно документа</em>, начинается в левом-верхнем углу, но не окна, а именно страницы.</p><p>И координаты в ней означают позицию по отношению не к окну браузера, а к документу в целом.</p><p>Если провести аналогию с CSS, то координаты относительно окна – это <code>position:fixed</code>, а относительно документа – <code>position:absolute</code> (при позиционировании вне других элементов, естественно).</p><p>Мы будем называть координаты в ней <code>pageX/pageY</code>.</p><p>Они нужны в первую очередь для того, чтобы показывать элемент в определённом месте страницы, а не окна.</p><h2><a name="0" href="#0">Сравнение систем координат</a></h2><p>Когда страница не прокручена, точки начала координат относительно окна <code>(clientX,clientY)</code> и документа <code>(pageX,pageY)</code> совпадают:</p><figure><img src="pagewindow0.png" alt="" width="100%" style="max-width:662px"></figure><p>Например, координаты элемента с надписью «STANDARDS» равны расстоянию от верхней/левой границы окна:</p><figure><img src="standards.png" alt="" width="100%" style="max-width:662px"></figure><p><strong>Прокрутим страницу, чтобы элемент был на самом верху:</strong></p><p>Посмотрите на рисунок ниже, на нём – та же страница, только прокрученная, и тот же элемент «STANDARDS».</p><ul><li>Координата <code>clientY</code> изменилась. Она была <code>175</code>, а стала <code>0</code>, так как элемент находится вверху окна.</li><li>Координата <code>pageY</code> осталась такой же, так как отсчитывается от левого-верхнего угла <em>документа</em>.</li></ul><figure><img src="standards-scroll.png" alt="" width="100%" style="max-width:672px"></figure><p>Итак, координаты <code>pageX/pageY</code> не меняются при прокрутке, в отличие от <code>clientX/clientY</code>.</p><h2><a name="1" href="#1">Получение координат</a></h2><p>К сожалению, готовой функции для получения координат элемента относительно страницы нет. Но её можно легко написать самим.</p><p>Эти две системы координат жёстко связаны: <code>pageY = clientY + текущая вертикальная прокрутка</code>.</p><p>Наша функция <code>getCoords(elem)</code> будет брать результат <code>elem.getBoundingClientRect()</code> и прибавлять текущую прокрутку документа.</p><p>Результат <code>getCoords</code>: объект с координатами <code>{left: .., top: ..}</code></p><code-example><script>`function getCoords(elem) { // кроме IE8-\n  var box = elem.getBoundingClientRect();\n\n  return {\n    top: box.top + pageYOffset,\n    left: box.left + pageXOffset\n  };\n}`</script></code-example><p>Если нужно поддерживать более старые IE, то вот альтернативный, самый кросс-браузерный вариант:</p><code-example><script>`function getCoords(elem) {\n  // (1)\n  var box = elem.getBoundingClientRect();\n\n  var body = document.body;\n  var docEl = document.documentElement;\n\n  // (2)\n  var scrollTop = window.pageYOffset || docEl.scrollTop || body.scrollTop;\n  var scrollLeft = window.pageXOffset || docEl.scrollLeft || body.scrollLeft;\n\n  // (3)\n  var clientTop = docEl.clientTop || body.clientTop || 0;\n  var clientLeft = docEl.clientLeft || body.clientLeft || 0;\n\n  // (4)\n  var top = box.top + scrollTop - clientTop;\n  var left = box.left + scrollLeft - clientLeft;\n\n  return {\n  top: top,\n  left: left\n };\n}`</script></code-example><p>Разберем что и зачем, по шагам:</p><ol><li>Получаем прямоугольник.</li><li>Считаем прокрутку страницы. Все браузеры, кроме IE8- поддерживают свойство <code>pageXOffset/pageYOffset</code>. В более старых IE, когда установлен DOCTYPE, прокрутку можно получить из <code>documentElement</code>, ну и наконец если DOCTYPE некорректен – использовать <code>body</code>.</li><li>В IE документ может быть смещен относительно левого верхнего угла. Получим это смещение.</li><li>Добавим прокрутку к координатам окна и вычтем смещение <code>html/body</code>, чтобы получить координаты нужного нам элемента.</li></ol><h3><a name="7" href="#7">Устаревший метод: offset*</a></h3><p>Есть альтернативный способ нахождения координат – это пройти всю цепочку <code>offsetParent</code> от элемента вверх и сложить отступы <code>offsetLeft/offsetTop</code>.</p><p>Мы разбираем его здесь с учебной целью, так как он используется лишь в старых браузерах.</p><p>Вот функция, реализующая такой подход.</p><code-example><script>`function getOffsetSum(elem) {\n  var top = 0,\n    left = 0;\n\n  while (elem) {\n    top = top + parseInt(elem.offsetTop);\n    left = left + parseInt(elem.offsetLeft);\n    elem = elem.offsetParent;\n  }\n\n  return {\n    top: top,\n    left: left\n  };\n}`</script></code-example><p>Казалось бы, код нормальный. И он как-то работает, но разные браузеры преподносят «сюрпризы», включая или выключая размер рамок и прокруток из <code>offsetTop/Left</code>, некорректно учитывая позиционирование. В итоге результат не всегда верен. Можно, конечно, разобрать эти проблемы и посчитать действительно аккуратно и правильно этим способом, но зачем? Ведь есть <code>getBoundingClientRect</code>.</p><p>Вы можете увидеть разницу между вычислением координат через <code>offset*</code> и <code>getBoundingClientRect</code> на примере.</p><p>В прямоугольнике ниже есть 3 вложенных <code>DIV</code>. Все они имеют <code>border</code>, кое-кто из них имеет <code>position/margin/padding</code>.</p><p>Кликните по внутреннему (жёлтому) элементу, чтобы увидеть результаты обоих методов: <code>getOffsetSum</code> и <code>getCoords</code>, а также реальные координаты курсора – <code>event.pageX/pageY</code> (мы обсудим их позже в статье <a data-load_page="135">Мышь: IE8-, исправление события</a>).</p><div style="position:relative;padding:10px;height:80px;width:380px;border:7px red solid"><div style="border:10px blue solid;padding:2px;position:absolute;left:20%;top:20%"><div id="getBoundingClientRectEx" style="background-color:yellow;font-size:14px;border:4px solid black;margin:2px;cursor:pointer">Кликните, чтобы получить координаты getOffsetSum и getCoords</div></div></div><div id="getBoundingClientRectExRes"><div><b>getOffsetSum</b>: <span>{left:454, top:4257}</span></div><div><b>getCoords</b>: <span>{left:470.9765625, top:4273.8671875}</span></div><div><b>mouse</b>: <span>pageX=527 pageY=4288</span></div></div><p><strong>При клике на любом месте желтого блока вы легко увидите разницу между <code>getOffsetSum(elem)</code> и <code>getCoords(elem)</code>.</strong></p><p>Для того, чтобы узнать, какой же результат верный, кликните в левом-верхнем углу жёлтого блока, причём обратите внимание – кликать нужно не на жёлтом, а на чёрном, это рамка, она тоже входит в элемент. Будут видны точные координаты мыши, так что вы можете сравнить их с <code>getOffsetSum/getCoords</code>.</p><p>Пример клика в правильном месте (обратите внимание на разницу координат):</p><figure><img src="getcoords-compare.png" alt="" width="100%" style="max-width:425px"></figure><p>Именно <code>getCoords</code> всегда возвращает верное значение.</p><h2><a name="2" href="#2">Координаты на экране screenX/screenY</a></h2><p>Есть ещё одна система координат, которая используется очень редко, но для полноты картины необходимо её упомянуть.</p><p><em>Координаты относительно экрана</em><code>screenX/screenY</code> отсчитываются от его левого-верхнего угла. Имеется в виду именно <em>весь экран</em>, а не окно браузера.</p><figure><img src="screen.png" alt="" width="100%" style="max-width:540px"></figure><p>Такие координаты могут быть полезны, например, при работе с мобильными устройствами или для открытия нового окна посередине экрана вызовом <a href="https://developer.mozilla.org/en-US/docs/DOM/window.open">window.open</a>.</p><ul><li><p>Размеры экрана хранятся в глобальной переменной <a href="https://developer.mozilla.org/en/DOM/window.screen">screen</a>:</p><code-example><script>`// общая ширина/высота\nalert( screen.width + ' x&nbsp' + screen.height );\n\n// доступная ширина/высота (за вычетом таскбара и т.п.)\nalert( screen.availWidth + ' x&nbsp' + screen.availHeight );\n\n// есть и ряд других свойств screen (см. документацию)`</script><code-toolbar></code-toolbar></code-example></li><li><p>Координаты левого-верхнего угла браузера на экране хранятся в <code>window.screenX,</code><code>window.screenY</code> (не поддерживаются IE8-):</p><code-example><script>`alert( "Браузер находится на&nbsp" + window.screenX + "," + window.screenY );`</script><code-toolbar></code-toolbar></code-example><p>Они могут быть и меньше нуля, если окно частично вне экрана.</p></li></ul><p>Заметим, что общую информацию об экране и браузере получить можно, а вот координаты конкретного элемента на экране – нельзя, нет аналога <code>getBoundingClientRect</code> или иного метода для этого.</p><h2><a name="3" href="#3">Итого</a></h2><p>У любой точки в браузере есть координаты:</p><ol><li>Относительно окна <code>window</code> – <code>elem.getBoundingClientRect()</code>.</li><li>Относительно документа <code>document</code> – добавляем прокрутку, во всех фреймворках есть готовая функция.</li><li>Относительно экрана <code>screen</code> – можно узнать координаты браузера, но не элемента.</li></ol><p>Иногда в старом коде можно встретить использование <code>offsetTop/Left</code> для подсчёта координат. Это очень старый и неправильный способ, не стоит его использовать.</p><p>Координаты будут нужны нам далее, при работе с событиями мыши (координаты клика) и элементами (перемещение).</p><h2 id="tasks"><a href="#4" name="4">Задачи (3)</a></h2><task-content><h3><a href="#8" name="8">Область видимости для документа</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 5</span><p>Напишите функцию <code>getDocumentScroll()</code>, которая возвращает объект с информацией о текущей прокрутке и области видимости.</p><p>Свойства объекта-результата:</p><ul><li><code>top</code> – координата верхней границы видимой части (относительно документа).</li><li><code>bottom</code> – координата нижней границы видимой части (относительно документа).</li><li><code>height</code> – полная высота документа, включая прокрутку.</li></ul><p>В этой задаче учитываем только вертикальную прокрутку: горизонтальная делается аналогично, а нужна сильно реже.</p><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><ul><li><code>top</code> – это <code>pageYOffset</code>.</li><li><code>bottom</code> – это <code>pageYOffset</code> плюс высота видимой части <code>documentElement.clientHeight</code>.</li><li><code>height</code> – полная высота документа, её вычисление дано в главе <a data-load_page="115">Размеры и прокрутка страницы</a>.</li></ul><p>Итого:</p><code-example><script>`function getDocumentScroll() {\n  var scrollHeight = Math.max(\n    document.body.scrollHeight, document.documentElement.scrollHeight,\n    document.body.offsetHeight, document.documentElement.offsetHeight,\n    document.body.clientHeight, document.documentElement.clientHeight\n  );\n\n  return {\n    top: pageYOffset,\n    bottom: pageYOffset + document.documentElement.clientHeight,\n    height: scrollHeight\n  };\n}`</script></code-example></task-answer></task-content><task-content><h3><a href="#9" name="9">Разместить заметку рядом с элементом (absolute)</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 5</span><p>Модифицируйте решение задачи <a data-load_page="116-2">Разместить заметку рядом с элементом</a>, чтобы при прокрутке страницы заметка не убегала от элемента.</p><p>Используйте для этого координаты относительно документа и <code>position:absolute</code> вместо <code>position:fixed</code>.</p><p>В качестве исходного документа используйте решение задачи <a data-load_page="116-2">Разместить заметку рядом с элементом</a>, для тестирования прокрутки добавьте стиль <code>&lt;body style="height: 2000px"&gt;</code>.</p><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><code-example><script>`<body style="height:2000px">\n  <style>\n    GOLD_.note_GOLD {\n      position: absolute;\n      z-index: 1000;\n      padding: 5px;\n      border: 1px solid black;\n      background: white;\n      text-align: center;\n      font: italic 14px Georgia;\n    }\n    \n    GOLD_blockquote_GOLD {\n      background: #f9f9f9;\n      BLUE_border-left_BLUE: 10px solid #ccc;\n      margin: 0 0 0 100px;\n      padding: .5em 10px;\n      BLUE_quotes_BLUE: "\\201C" "\\201D" "\\2018" "\\2019";\n      display: inline-block;\n      white-space: pre;\n    }\n    \n    GOLD_blockquote:before_GOLD {\n      color: #ccc;\n      content: open-quote;\n      font-size: 4em;\n      line-height: .1em;\n      margin: 0 .25em 0 0;\n      vertical-align: -.4em;\n    }\n  </style>\n  <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reprehenderit sint atque dolorum fuga ad incidunt voluptatum error fugiat animi amet! Odio temporibus nulla id unde quaerat dignissimos enim nisi rem provident molestias sit tempore omnis recusandae esse sequi officia sapiente.\n  </p>\n  <RED_blockquote_RED>\n    - Что на завтрак, Бэрримор? \n    - Овсянка, сэр. \n    - А на обед? \n    - Овсянка, сэр. \n    - Ну а на ужин? \n    - Котлеты, сэр. \n    - Уррра!!! \n    - Из овсянки, сэр!!!\n  </RED_blockquote_RED>\n  <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reprehenderit sint atque dolorum fuga ad incidunt voluptatum error fugiat animi amet! Odio temporibus nulla id unde quaerat dignissimos enim nisi rem provident molestias sit tempore omnis recusandae esse sequi officia sapiente.\n  </p>\n  <script>\n    // Вспомогательная функция для координат относительно документа\n    function getCoords(elem) {\n      var box = elem.getBoundingClientRect();\n\n      var body = document.body;\n      var docEl = document.documentElement;\n\n      var scrollTop = window.pageYOffset || docEl.scrollTop || body.scrollTop;\n      var scrollLeft = window.pageXOffset || docEl.scrollLeft || body.scrollLeft;\n\n      var clientTop = docEl.clientTop || body.clientTop || 0;\n      var clientLeft = docEl.clientLeft || body.clientLeft || 0;\n\n      var top = box.top + scrollTop - clientTop;\n      var left = box.left + scrollLeft - clientLeft;\n\n      return {\n        top: top,\n        left: left\n      };\n    }\n\n    function positionAt(anchor, position, elem) {\n      var anchorCoords = getCoords(anchor);\n      switch (position) {\n        case "top":\n          elem.style.left = anchorCoords.left + "px";\n          elem.style.top = anchorCoords.top - elem.offsetHeight + "px";\n          break;\n        case "right":\n          elem.style.left = anchorCoords.left + anchor.offsetWidth + "px";\n          elem.style.top = anchorCoords.top + "px";\n          break;\n        case "bottom":\n          elem.style.left = anchorCoords.left + "px";\n          elem.style.top = anchorCoords.top + anchor.offsetHeight + "px";\n          break;\n      }\n    }\n    /**\nCOMMENT     * Показывает заметку с текстом html на позиции position\nCOMMENT     * относительно элемента anchor\n     */\n    function showNote(anchor, position, html) {\n      var note = document.createElement('div');\n      note.className = "note";\n      note.innerHTML = html;\n      document.body.appendChild(note);\n      positionAt(anchor, position, note);\n    }\n\n    // проверка работоспособности\n    var blockquote = document.querySelector('blockquote');\n    showNote(blockquote, "top", "заметка сверху");\n    showNote(blockquote, "right", "заметка справа");\n    showNote(blockquote, "bottom", "заметка снизу");\n  <\/script>\n</body>`</script><code-toolbar iframe="630"><a title="показать" data-code_run="0"></a><a id="task_2" data-code_edit="?" style="display:none"></a><a id="answer_2" title="открыть в песочнице" data-code_edit=""></a></code-toolbar></code-example><p><a data-click="answer_2">Открыть решение в песочнице.</a></p></task-answer></task-content><task-content><h3><a href="#10" name="10">Разместить заметку внутри элемента</a><task-open hover-style="" data-show_task="" title="Открыть задачу"></task-open></h3><span title="Насколько эта задача важна для освоения материала, от 1 до 5">важность: 5</span><p>Расширьте предыдущую задачу <a data-load_page="117-2">Разместить заметку рядом с элементом (absolute)</a>: научите функцию <code>positionAt(anchor, position, elem)</code> вставлять <code>elem</code> внутрь <code>anchor</code>.</p><p>Новые значения <code>position</code>:</p><ul><li><code>top-out</code>, <code>right-out</code>, <code>bottom-out</code> – работают так же, как раньше, то есть вставляют <code>elem</code> над/справа/под <code>anchor</code>.</li><li><code>top-in</code>, <code>right-in</code>, <code>bottom-in</code> – вставляют <code>elem</code> внутрь <code>anchor</code>: к верхней границе/правой/нижней.</li></ul><p>Например:</p><code-example><script>`// покажет note сверху blockquote\npositionAt(blockquote, "top-out", note);\n\n// покажет note сверху-внутри blockquote\npositionAt(blockquote, "top-in", note);`</script></code-example><p>Пример результата:</p><figure- id="position_note"><code-toolbar-><div></div><a title="открыть в новом окне" data-new_window=""></a><a title="открыть в песочнице" data-code_edit=""></a></code-toolbar-><style> .note{position:fixed;z-index:1000;padding:5px;border:1px solid black;background:white;text-align:center;font:italic 14px Georgia;opacity:.8;} #anchor{background:#f9f9f9;border-left:10px solid #ccc;margin:0 0 0 100px;padding:.5em 10px;/*quotes:"\201C""\201D""\2018""\2019";*/ display:inline-block;white-space:pre;} #anchor:before{content:url('left-quote.svg');/*color:#ccc;content:open-quote;font-size:4em;line-height:.1em;margin-right:.25em;vertical-align:-.4em;*/} </style><p></p><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reprehenderit sint atque dolorum fuga ad incidunt voluptatum error fugiat animi amet! Odio temporibus nulla id unde quaerat dignissimos enim nisi rem provident molestias sit tempore omnis recusandae esse sequi officia sapiente.</p><pre id="anchor"> 
- Что на завтрак, Бэрримор? 
- Овсянка, сэр. 
- А на обед? 
- Овсянка, сэр. 
- Ну а на ужин? 
- Котлеты, сэр. 
- Уррра!!! 
- Из овсянки, сэр!!!
</pre><p style="margin-top:1em;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reprehenderit sint atque dolorum fuga ad incidunt voluptatum error fugiat animi amet! Odio temporibus nulla id unde quaerat dignissimos enim nisi rem provident molestias sit tempore omnis recusandae esse sequi officia sapiente.</p><input onclick="newNote.show()" type="button" value="поставить заметки"><script> function NewNote(){var anchor=document.body.querySelector('#anchor');var parent=anchor.parentElement;var anchorCoords;this.show=function(){anchorCoords=anchor.getBoundingClientRect();showNote(anchorCoords,"top-in","заметка top-in");showNote(anchorCoords,"top-out","заметка top-out");showNote(anchorCoords,"right-out","заметка right-out");showNote(anchorCoords,"bottom-in","заметка bottom-in");};function showNote(anchorCoords,position,html){var note=document.createElement('div');note.id='removable';note.className="note";note.innerHTML=html;parent.appendChild(note);switch (position){case "top-out":note.style.left=anchorCoords.left+"px";note.style.top=anchorCoords.top-note.offsetHeight+"px";break;case "right-out":note.style.left=anchorCoords.left+anchor.offsetWidth+"px";note.style.top=anchorCoords.top+"px";break;case "bottom-out":note.style.left=anchorCoords.left+"px";note.style.top=anchorCoords.top+anchor.offsetHeight+"px";break;case "top-in":note.style.left=anchorCoords.left+"px";note.style.top=anchorCoords.top+"px";break;case "right-in":note.style.width='150px';note.style.left=anchorCoords.left+anchor.offsetWidth-note.offsetWidth+"px";note.style.top=anchorCoords.top+"px";break;case "bottom-in":note.style.left=anchorCoords.left+"px";note.style.top=anchorCoords.top+anchor.offsetHeight-note.offsetHeight+"px";break;}}}window.newNote=new NewNote();</script></figure-><p>В качестве исходного документа возьмите решение задачи <a data-load_page="117-2">Разместить заметку рядом с элементом (absolute)</a>.</p><button-answer data-toggle_answer="" style="">решение</button-answer><task-answer><close- title="закрыть" data-close_answer=""></close-><code-example><script>`<body style="height:2000px">\n  <style>\n    GOLD_.note_GOLD {\n      position: absolute;\n      z-index: 1000;\n      padding: 5px;\n      border: 1px solid black;\n      background: white;\n      text-align: center;\n      font: italic 14px Georgia;\n    }\n    \n    GOLD_blockquote_GOLD {\n      background: #f9f9f9;\n      BLUE_border-left_BLUE: 10px solid #ccc;\n      margin: 0 0 0 100px;\n      padding: .5em 10px;\n      BLUE_quotes_BLUE: "\\201C" "\\201D" "\\2018" "\\2019";\n      display: inline-block;\n      white-space: pre;\n    }\n    \n    GOLD_blockquote:before_GOLD {\n      color: #ccc;\n      content: open-quote;\n      font-size: 4em;\n      line-height: .1em;\n      margin: 0 .25em 0 0;\n      vertical-align: -.4em;\n    }\n  </style>\n  <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reprehenderit sint atque dolorum fuga ad incidunt voluptatum error fugiat animi amet! Odio temporibus nulla id unde quaerat dignissimos enim nisi rem provident molestias sit tempore omnis recusandae esse sequi officia sapiente.\n  </p>\n  <RED_blockquote_RED>\n    - Что на завтрак, Бэрримор? \n    - Овсянка, сэр. \n    - А на обед? \n    - Овсянка, сэр. \n    - Ну а на ужин? \n    - Котлеты, сэр. \n    - Уррра!!! \n    - Из овсянки, сэр!!!\n  </RED_blockquote_RED>\n  <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reprehenderit sint atque dolorum fuga ad incidunt voluptatum error fugiat animi amet! Odio temporibus nulla id unde quaerat dignissimos enim nisi rem provident molestias sit tempore omnis recusandae esse sequi officia sapiente.\n  </p>\n  <script>\n    function getCoords(elem) {\n      var box = elem.getBoundingClientRect();\n\n      var body = document.body;\n      var docEl = document.documentElement;\n\n      var scrollTop = window.pageYOffset || docEl.scrollTop || body.scrollTop;\n      var scrollLeft = window.pageXOffset || docEl.scrollLeft || body.scrollLeft;\n\n      var clientTop = docEl.clientTop || body.clientTop || 0;\n      var clientLeft = docEl.clientLeft || body.clientLeft || 0;\n\n      var top = box.top + scrollTop - clientTop;\n      var left = box.left + scrollLeft - clientLeft;\n\n      return {\n        top: top,\n        left: left\n      };\n    }\n\n    function showNote(anchor, position, html) {\n      var note = document.createElement('div');\n      note.className = "note";\n      note.innerHTML = html;\n      document.body.appendChild(note);\n      positionAt(anchor, position, note);\n    }\n    \n    function positionAt(anchor, position, elem) {\n      var anchorCoords = getCoords(anchor);\n      switch (position) {\n        case "top-out":\n          elem.style.left = anchorCoords.left + "px";\n          elem.style.top = anchorCoords.top - elem.offsetHeight + "px";\n          break;\n        case "right-out":\n          elem.style.left = anchorCoords.left + anchor.offsetWidth + "px";\n          elem.style.top = anchorCoords.top + "px";\n          break;\n        case "bottom-out":\n          elem.style.left = anchorCoords.left + "px";\n          elem.style.top = anchorCoords.top + anchor.offsetHeight + "px";\n          break;\n        case "top-in":\n          elem.style.left = anchorCoords.left + "px";\n          elem.style.top = anchorCoords.top + "px";\n          break;\n        case "right-in":\n          elem.style.width = '150px';\n          elem.style.left = anchorCoords.left + anchor.offsetWidth - elem.offsetWidth + "px";\n          elem.style.top = anchorCoords.top + "px";\n          break;\n        case "bottom-in":\n          elem.style.left = anchorCoords.left + "px";\n          elem.style.top = anchorCoords.top + anchor.offsetHeight - elem.offsetHeight + "px";\n          break;\n      }\n    }\n\n    var blockquote = document.querySelector('blockquote');\n    \n    showNote(blockquote, "top-in", "заметка top-in");\n    showNote(blockquote, "top-out", "заметка top-out");\n    showNote(blockquote, "right-out", "заметка right-out");\n    showNote(blockquote, "bottom-in", "заметка bottom-in");\n  <\/script>\n</body>`</script><code-toolbar iframe="430"><a title="показать" data-code_run="0"></a><a id="task_2" data-code_edit="?" style="display:none"></a><a id="answer_2" title="открыть в песочнице" data-code_edit=""></a></code-toolbar></code-example><p><a data-click="answer_2">Открыть решение в песочнице.</a></p></task-answer></task-content><banner-bottom class="banner-bottom" style="display: block;"></banner-bottom><script>! function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||screen.width<1024||"bannerBottomDisabled" in localStorage||(localStorage.bannerBottomShownCount||(localStorage.bannerBottomShownCount=1),document.querySelector(".banner-bottom").style.display="block")}();</script><nav-book data-tooltips="Координаты в окне; Итого"></nav-book><share-map><share-></share-><map-button hover-style="" data-load_page="l"></map-button></share-map><comments- id="comments"></comments-><div id="disqus_thread"></div><script>disqus_url="https:\/\/learn.javascript.ru\/coordinates-document",disqus_identifier="coordinates-document",disqus_title="\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435";</script></page-content></main>