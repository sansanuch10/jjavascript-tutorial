<!DOCTYPE html><html><head><meta charset="utf-8"></head><body><fieldset><legend>Алгоритм 1.</legend><ol><li>Все <code>TR</code> удалить из таблицы, при этом собрав их в JavaScript-массив.</li><li>Отсортировать этот массив, используя свою функцию в <code>sort(...)</code> для сравнения <code>TR</code></li><li>Добавить <code>TR</code> из массива в таблицу в нужном порядке</li></ol><button onclick="bench(sort1,this)">Померять время</button></fieldset><fieldset><legend>Алгоритм 2.</legend><ol><li>Скопировать <code>TR</code> в JavaScript-массив.</li><li>Отсортировать этот массив, используя свою функцию в <code>sort(...)</code> для сравнения <code>TR</code></li><li>Добавить <code>TR</code> из массива в таблицу в нужном порядке. При добавлении каждый <code>TR</code> сам удалится с предыдущего места.</li></ol><button onclick="bench(sort2,this)">Померять время</button></fieldset><fieldset><legend>Алгоритм 3.</legend><ol><li>Создать массив из объектов вида <code>{elem: ссылка на TR, value: содержимое TR}</code>.</li><li>Отсортировать массив по <code>value</code>. Функция сравнения во время сортировки теперь будет обращаться не к <code>innerHTML</code>, а к свойству объекта, это быстрее. Сортировка может потребовать многократных сравнений одного и того же элемента, отсюда выигрыш.</li><li>Добавить <code>TR</code> в таблицу в нужном порядке (автоудалятся с предыдущего места).</li></ol><button onclick="bench(function(){sortOpt(!1)},this)">Померять время</button></fieldset><fieldset><legend>Алгоритм 4.</legend><ol><li>Выполнить алгоритм 3, но перед этим удалить таблицу из документа, а после - вставить обратно.</li></ol><button onclick="bench(function(){sortOpt(!0)},this)">Померять время</button></fieldset><fieldset><legend>Алгоритм 5.</legend><ol><li>Замерить время генерации таблицы (создаётся строка и пишется в <code>innerHTML</code>).</li></ol><button onclick="benchMake(this)">Померять время</button></fieldset><div id="table_holder"></div><h3>Содержимое документа для придания "реалистичности"</h3><script>function makeTable(){var tableHolder=document.getElementById('table_holder');var contents='<thead><th>Имя</th><th>Фамилия</th><th>Отчество</th><th>Возраст</th></thead>';contents+='<tbody>';for(var i=0;i<100;i++){contents+="<tr><td> ... </td><td>Разные</td><td>Данные</td><td>"+((i+50)%30)+"</td></tr>"}
contents+='</tbody>';tableHolder.innerHTML='<table>'+contents+'</table>'}/* перенести элементы в массив, отсортировать его и перевставить
*/
function sort1(){var tbody=table_holder.getElementsByTagName('tbody')[0];var rows=[];for(var i=tbody.children.length-1;i>=0;i--){var child=tbody.removeChild(tbody.children[i]);rows.push(child)}
rows.sort(function(a,b){return a.lastChild.innerHTML-b.lastChild.innerHTML});for(var i=0;i<rows.length;i++){tbody.appendChild(rows[i])}}/* перенести элементы в массив, отсортировать его и перевставить
*/
function sort2(){var tbody=table_holder.getElementsByTagName('tbody')[0];var rows=[];for(var i=0;i<tbody.children.length;i++){rows.push(tbody.children[i])}
rows.sort(function(a,b){return a.lastChild.innerHTML-b.lastChild.innerHTML});for(var i=0;i<rows.length;i++){tbody.appendChild(rows[i])}}/* создать массив из значений и ссылок, отсортировать, перевставить
doRemove = предварительно вынуть из документа
*/
function sortOpt(doRemove){var tbody=table_holder.getElementsByTagName('tbody')[0];var table=tbody.parentNode;if(doRemove)table.removeChild(tbody);var rows=[];for(var i=0;i<tbody.children.length;i++){var elem=tbody.children[i];rows.push({value:elem.lastChild.innerHTML,elem:elem})}
rows.sort(function(a,b){return a.value-b.value});for(var i=0;i<rows.length;i++){tbody.appendChild(rows[i].elem)}
if(doRemove)table.appendChild(tbody)}
function bench(f,elem){var sum=0;for(var i=0;i<100;i++){makeTable();var d=new Date;f();sum+=new Date-d}
elem.innerHTML=sum+'мс'}
function benchMake(elem){var sum=0;for(var i=0;i<100;i++){var d=new Date;makeTable();sum+=new Date-d}
elem.innerHTML=sum+'мс'}/* Содержимое документа для придания "реалистичности"
*/
for(let i=0,div,span;i<31;i++){div=document.createElement('div');document.body.appendChild(div);for(let j=0;j<51;j++){span=document.createElement('span');if(j<10)
span.innerHTML=j;else span.innerHTML=j.toString().slice(1);div.appendChild(span)}}</script></body></html>
