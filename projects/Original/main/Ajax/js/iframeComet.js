var IframeComet=new function(){var e,n,t,o=this,i=0;function c(){t&&t.remove()}this.onConnected=function(){i=0,clearTimeout(e)},this.onMessage=function(e){},this.onError=function(e){},this.open=function(r){var a;++i>3&&o.onError("Unable to connect"),"ActiveXObject"in window?function(e){c(),n||((n=new ActiveXObject("htmlfile")).open(),n.write("<html><body></body></html>"),n.close(),n.parentWindow.IframeComet=o);e=e||"javascript:false",n.body.insertAdjacentHTML("beforeEnd","<iframe src='"+e+"'></iframe>"),t=n.body.lastChild}(r):(a=r,c(),(t=document.createElement("iframe")).src=a||"javascript:false",t.style.display="none",document.body.appendChild(t)),e=setTimeout(function(){o.isConnected()||o.open(r)},2e3*i),t.onload=function(){o.open(r)}},this.isConnected=function(){return 0==i}};