function fixIERangeObject(e,t){if(t=t||window,!e)return null;if(!e.startContainer&&t.document.selection){var n=function(e,t){for(var n=null,o=-1,r=e.firstChild;r;r=r.nextSibling)if(3==r.nodeType){var i=r.nodeValue;if(0!=t.indexOf(i)||t==i){n=r,o=t.length-1;break}t=t.substring(i.length)}return{node:n,offset:o}},o=e.duplicate(),r=e.duplicate(),i=e.duplicate(),a=e.duplicate();o.collapse(!0),o.moveEnd("character",1),r.collapse(!1),r.moveStart("character",-1);var l=o.parentElement(),c=r.parentElement();if(l instanceof HTMLInputElement||c instanceof HTMLInputElement)return null;i.moveToElementText(l),i.setEndPoint("EndToEnd",o),a.moveToElementText(c),a.setEndPoint("EndToEnd",r);var f=i.text,d=a.text,u=n(l,f),s=n(c,d);e.startContainer=u.node,e.startOffset=u.offset,e.endContainer=s.node,e.endOffset=s.offset+1}return e}function getRangeObject(e){if((e=e||window).getSelection)try{return e.getSelection().getRangeAt(0)}catch(e){}else if(e.document.selection){return fixIERangeObject(e.document.selection.createRange(),e)}return null}